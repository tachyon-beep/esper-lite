{
  "kasmina_commands": [
    {
      "command_id": "training-run-conservative"
    }
  ],
  "kasmina_finalize": [
    1
  ],
  "metrics_snapshot": {
    "tolaria.breaker.state": 1.0,
    "tolaria.emergency.shared_signal_mode": 0.0,
    "tolaria.epochs.failed": 1.0,
    "tolaria.epochs.total": 1.0,
    "tolaria.grad_agg.conflict_ratio": 0.0,
    "tolaria.grad_agg.conflicts": 0.0,
    "tolaria.grad_agg.microbatches_total": 2.0,
    "tolaria.grad_agg.pcgrad_applied": 0.0,
    "tolaria.grad_agg.teacher_share": 0.0,
    "tolaria.grad_agg.weights_mean": 0.0,
    "tolaria.hook.latency_ms": 1.0657439997885376,
    "tolaria.lr_controller.enabled": 0.0,
    "tolaria.mode.conservative": 1.0,
    "tolaria.profiler.enabled": 0.0,
    "tolaria.profiler.traces_emitted_total": 0.0,
    "tolaria.train.amp_enabled": 0.0,
    "tolaria.train.compile_enabled": 0.0,
    "tolaria.train.foreach_enabled": 0.0,
    "tolaria.train.pin_memory": 0.0,
    "tolaria.train.tf32_enabled": 0.0
  },
  "state_packets": [
    {
      "experiment_name": "placeholder-experiment",
      "hardware_context": {
        "available_memory_gb": 0.5325928,
        "device_id": "0",
        "device_type": "cuda",
        "total_memory_gb": 15.573853
      },
      "packet_id": "training-run-epoch-0",
      "source_subsystem": "tolaria",
      "timestamp_ns": "1758872467262760140",
      "training_loss": 0.2543949,
      "training_metrics": {
        "accuracy": 0.5,
        "cpu_util_percent": 9.4,
        "gpu_mem_free_gb": 0.5325928,
        "gpu_mem_used_gb": 15.04126,
        "grad_conflict_rate": 0.0,
        "grad_norm_ewma": 0.49115893,
        "grad_var": 0.9649484,
        "gradient_norm": 0.20464955,
        "latency_ms": 45.47374,
        "loss": 0.2543949,
        "loss_ewma": 0.19573453,
        "loss_volatility": 0.39146906,
        "samples_per_s": 263.88858
      },
      "training_run_id": "training-run",
      "validation_accuracy": 0.5,
      "validation_loss": 0.2543949,
      "version": 1
    },
    {
      "current_epoch": 1,
      "experiment_name": "placeholder-experiment",
      "global_step": "1",
      "hardware_context": {
        "available_memory_gb": 0.5325928,
        "device_id": "0",
        "device_type": "cuda",
        "total_memory_gb": 15.573853
      },
      "packet_id": "training-run-epoch-1",
      "source_subsystem": "tolaria",
      "timestamp_ns": "1758872467383747574",
      "training_metrics": {
        "accuracy": 0.0,
        "cpu_util_percent": 7.7,
        "gpu_mem_free_gb": 0.5325928,
        "gpu_mem_used_gb": 15.04126,
        "grad_conflict_rate": 0.0,
        "grad_norm_ewma": 0.49115893,
        "grad_var": 0.9649484,
        "gradient_norm": 0.0,
        "loss": 0.0,
        "loss_ewma": 0.19573453,
        "loss_volatility": 0.39146906
      },
      "training_run_id": "training-run",
      "validation_accuracy": 1.0,
      "version": 1
    }
  ],
  "tamiyo_commands": [],
  "tamiyo_step_packets": [
    {
      "global_step": "1",
      "packet_id": "training-run-step-1",
      "source_subsystem": "tolaria",
      "timestamp_ns": "1758872467261296130",
      "training_loss": 0.9786726,
      "training_metrics": {
        "grad_conflict_rate": 0.0,
        "grad_norm_ewma": 0.49115893,
        "grad_var": 0.9649484,
        "gradient_norm": 2.4557948,
        "h2d_copy_ms": 0.0,
        "loss": 0.9786726,
        "loss_delta": 0.0,
        "loss_ewma": 0.19573453,
        "loss_volatility": 0.39146906,
        "optimizer_family_index": 0.0,
        "optimizer_lr": 0.05,
        "samples_per_s": 183.08652
      },
      "training_run_id": "training-run",
      "validation_loss": 0.9786726,
      "version": 1
    }
  ],
  "telemetry": [
    {
      "events": [
        {
          "attributes": {
            "index": "0",
            "name": "sgd"
          },
          "description": "optimizer_family",
          "event_id": "evt-1",
          "level": "TELEMETRY_LEVEL_INFO"
        },
        {
          "attributes": {
            "error": "AttributeError"
          },
          "description": "tolaria.tamiyo_error",
          "event_id": "evt-2",
          "level": "TELEMETRY_LEVEL_WARNING"
        },
        {
          "attributes": {
            "reason": "tamiyo_error"
          },
          "description": "tolaria.conservative_mode_entered",
          "event_id": "evt-3",
          "level": "TELEMETRY_LEVEL_WARNING"
        }
      ],
      "level": "TELEMETRY_LEVEL_INFO",
      "metrics": [
        {
          "name": "tolaria.training.loss",
          "unit": "loss",
          "value": 0.25439487894376117
        },
        {
          "name": "tolaria.training.accuracy",
          "unit": "ratio",
          "value": 0.5
        },
        {
          "name": "tolaria.training.latency_ms",
          "unit": "ms",
          "value": 45.473737991414964
        },
        {
          "name": "tolaria.seeds.active",
          "unit": "count"
        },
        {
          "name": "tolaria.epoch_hook.latency_ms",
          "unit": "ms",
          "value": 1.0657439997885376
        },
        {
          "name": "tolaria.breaker.state",
          "unit": "state",
          "value": 1.0
        },
        {
          "name": "tolaria.mode.conservative",
          "unit": "bool",
          "value": 1.0
        },
        {
          "name": "tolaria.epochs.total",
          "unit": "count",
          "value": 1.0
        },
        {
          "name": "tolaria.epochs.failed",
          "unit": "count",
          "value": 1.0
        },
        {
          "name": "tolaria.hook.latency_ms",
          "unit": "ms",
          "value": 1.0657439997885376
        },
        {
          "name": "tolaria.train.compile_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.amp_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.tf32_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.foreach_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.pin_memory",
          "unit": "bool"
        },
        {
          "name": "tolaria.lr_controller.enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.lr_controller.current_lr",
          "unit": "lr"
        },
        {
          "name": "tolaria.opt.rebuilds_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_failures_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_latency_ms",
          "unit": "ms"
        },
        {
          "name": "tolaria.rollback.fast_size_bytes",
          "unit": "bytes"
        },
        {
          "name": "tolaria.rollback.fast_hits_total",
          "unit": "count"
        },
        {
          "name": "tolaria.rollback.fast_misses_total",
          "unit": "count"
        },
        {
          "name": "tolaria.rollback.restore_latency_ms",
          "unit": "ms"
        },
        {
          "name": "tolaria.rollback.snapshots_total",
          "unit": "count"
        },
        {
          "name": "tolaria.grad_agg.microbatches_total",
          "unit": "count",
          "value": 2.0
        },
        {
          "name": "tolaria.grad_agg.conflicts",
          "unit": "count"
        },
        {
          "name": "tolaria.grad_agg.weights_mean",
          "unit": "ratio"
        },
        {
          "name": "tolaria.grad_agg.pcgrad_applied",
          "unit": "bool"
        },
        {
          "name": "tolaria.grad_agg.conflict_ratio",
          "unit": "ratio"
        },
        {
          "name": "tolaria.profiler.enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.profiler.traces_emitted_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_skipped_total",
          "unit": "count"
        },
        {
          "name": "tolaria.emergency.halts_total",
          "unit": "count"
        },
        {
          "name": "tolaria.emergency.halt",
          "unit": "bool"
        },
        {
          "name": "tolaria.grad_agg.teacher_share",
          "unit": "grad"
        }
      ],
      "packet_id": "training-run-epoch-0",
      "source_subsystem": "tolaria",
      "system_health": {
        "indicators": {
          "epoch": "0",
          "priority": "MESSAGE_PRIORITY_HIGH"
        },
        "status": "HEALTH_STATUS_DEGRADED",
        "summary": "tolaria.tamiyo_error"
      },
      "timestamp": "2025-09-26T07:41:07.378466Z"
    },
    {
      "level": "TELEMETRY_LEVEL_INFO",
      "metrics": [
        {
          "name": "tolaria.training.loss",
          "unit": "loss"
        },
        {
          "name": "tolaria.training.accuracy",
          "unit": "ratio"
        },
        {
          "name": "tolaria.training.latency_ms",
          "unit": "ms"
        },
        {
          "name": "tolaria.seeds.active",
          "unit": "count"
        },
        {
          "name": "tolaria.breaker.state",
          "unit": "state",
          "value": 1.0
        },
        {
          "name": "tolaria.mode.conservative",
          "unit": "bool",
          "value": 1.0
        },
        {
          "name": "tolaria.epochs.total",
          "unit": "count",
          "value": 1.0
        },
        {
          "name": "tolaria.epochs.failed",
          "unit": "count",
          "value": 1.0
        },
        {
          "name": "tolaria.hook.latency_ms",
          "unit": "ms",
          "value": 1.0657439997885376
        },
        {
          "name": "tolaria.train.compile_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.amp_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.tf32_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.foreach_enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.train.pin_memory",
          "unit": "bool"
        },
        {
          "name": "tolaria.lr_controller.enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.lr_controller.current_lr",
          "unit": "lr"
        },
        {
          "name": "tolaria.opt.rebuilds_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_failures_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_latency_ms",
          "unit": "ms"
        },
        {
          "name": "tolaria.rollback.fast_size_bytes",
          "unit": "bytes"
        },
        {
          "name": "tolaria.rollback.fast_hits_total",
          "unit": "count"
        },
        {
          "name": "tolaria.rollback.fast_misses_total",
          "unit": "count"
        },
        {
          "name": "tolaria.rollback.restore_latency_ms",
          "unit": "ms"
        },
        {
          "name": "tolaria.rollback.snapshots_total",
          "unit": "count"
        },
        {
          "name": "tolaria.grad_agg.microbatches_total",
          "unit": "count",
          "value": 2.0
        },
        {
          "name": "tolaria.grad_agg.conflicts",
          "unit": "count"
        },
        {
          "name": "tolaria.grad_agg.weights_mean",
          "unit": "ratio"
        },
        {
          "name": "tolaria.grad_agg.pcgrad_applied",
          "unit": "bool"
        },
        {
          "name": "tolaria.grad_agg.conflict_ratio",
          "unit": "ratio"
        },
        {
          "name": "tolaria.profiler.enabled",
          "unit": "bool"
        },
        {
          "name": "tolaria.profiler.traces_emitted_total",
          "unit": "count"
        },
        {
          "name": "tolaria.opt.rebuild_skipped_total",
          "unit": "count"
        },
        {
          "name": "tolaria.emergency.halts_total",
          "unit": "count"
        },
        {
          "name": "tolaria.emergency.halt",
          "unit": "bool"
        },
        {
          "name": "tolaria.grad_agg.teacher_share",
          "unit": "grad"
        }
      ],
      "packet_id": "training-run-epoch-1",
      "source_subsystem": "tolaria",
      "system_health": {
        "indicators": {
          "epoch": "1",
          "priority": "MESSAGE_PRIORITY_NORMAL"
        },
        "status": "HEALTH_STATUS_HEALTHY",
        "summary": "stable"
      },
      "timestamp": "2025-09-26T07:41:07.383911Z"
    }
  ]
}