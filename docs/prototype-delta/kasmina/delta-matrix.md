# Kasmina — Delta Matrix

Status and evidence per requirement. See rubric in `../rubric.md`.

| Area | Design Source | Expected Behaviour | Prototype Evidence | Status | Severity | Notes |
| --- | --- | --- | --- | --- | --- | --- |
| Lifecycle states & gates | `02-kasmina-unified-design.md` (Lifecycle, v4.0), 11‑state with G0–G5 | Enforce 11 states with validation gates; transitions guarded | `src/esper/kasmina/lifecycle.py`, `src/esper/kasmina/gates.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | Uses Leyline 11‑state enums; G0–G5 evaluated via `KasminaGates`; cull→embargo→reset path implemented. |
| Lifecycle fast path | `02-kasmina.md` | Allow germinating→training fast path | `tests/kasmina/test_lifecycle.py` | Implemented | Nice‑to‑have | Covered by tests. |
| Kernel execution (Urza/Tezzeret) | `02.1-kasmina-kernel-execution.md` | Load vetted kernel artefacts; async path; GPU cache | `src/esper/kasmina/seed_manager.py`, `src/esper/kasmina/prefetch.py` | Implemented | Should‑have | Async prefetch path integrated (PrefetchCoordinator + Urza worker); attaches on `KernelArtifactReady`; synchronous fallback remains as safety net. |
| Fallback kernel | `02.1-kasmina-kernel-execution.md` | Identity/fallback kernel on failure or latency breach | `src/esper/kasmina/seed_manager.py` (`_load_fallback`) | Implemented | Should‑have | Budget breach triggers fallback and telemetry. |
| Gradient isolation invariant | `02-kasmina-unified-design.md`, `02.1-kasmina-kernel-execution.md` | Runtime enforcement via backward hooks; `.detach()` in blending; breaker on violation | `src/esper/kasmina/isolation.py`, `src/esper/kasmina/blending.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | Projection-based monitoring, stage-scoped hooks, and dedicated isolation breaker with CRITICAL telemetry on open. |
| Alpha blending phases | `02-kasmina-unified-design.md` | Blend outputs during grafting; identity in training | `src/esper/kasmina/blending.py`, `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | Alpha blender `.detach()` + schedule implemented; `advance_alpha(seed_id)` helper present; per‑batch calls from training loop pending. |
| Parameter registration | `02.3-kasmina-parameter-registration.md` | Register per‑seed params; validate updates; teacher immutability | `src/esper/kasmina/registry.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | Per‑seed ownership, teacher registration, and `validate_update` path present. |
| Memory governance | `02.2-kasmina-memory-pools.md` | TTL caches, epoch GC, KD memory budgeting | `src/esper/kasmina/memory.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Should‑have | Adds epoch-driven GC telemetry, emergency purge, and teacher memory budgeting telemetry. |
| Safety stack (breaker/timers) | `02.4-kasmina-safety-mechanisms.md` | Circuit breakers, monotonic timing, pause/identity semantics | `src/esper/kasmina/safety.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Should‑have | Circuit breakers now emit WARN/CRITICAL telemetry; pause/resume commands swap identity kernels and validate on resume; emergency cleanup command wired in. |
| torch.compile fallback | `02.4-kasmina-safety-mechanisms.md` | Monitor and fall back on instability | — | Missing | Nice‑to‑have | Not implemented. |
| Security envelope | `02-kasmina-unified-design.md` | HMAC‑SHA256, nonce, freshness on critical commands | `src/esper/kasmina/security.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | HMAC verification, nonce ledger, and freshness window enforced for commands (env‑backed key). |
| Telemetry pipeline | `02-kasmina-unified-design.md` | Structured metrics/events, emergency bypass for critical alerts | `src/esper/core/telemetry.py`; seed_manager emissions | Partially Implemented | Should‑have | Adds GPU/GPU cache metrics, isolation breaker CRITICAL events, prefetch milestones, and exposes packet priorities. Emergency routing handled at Oona/Weatherlight; Kasmina does not publish directly. |
| Performance validation | `02.5-kasmina-performance-validation.md` | Benchmarks for kernel load, isolation overhead, Leyline limits, KD costs | — | Missing | Nice‑to‑have | No harness in prototype for Kasmina; broader profiling exists elsewhere. |
| Distributed coordination | `02-kasmina-unified-design.md` | Epoch‑aligned barriers; Byzantine logging | `src/esper/kasmina/seed_manager.py` | Partially Implemented | Nice‑to‑have | Epoch index surfaced in `export_seed_states()`; barriers/quorum are future work. |
| Knowledge distillation (C‑024) | `02-kasmina-unified-design.md`, `02.1`, `02.2` | Teacher load/checkpointing; KD loss plumbing; memory budgeting | `src/esper/kasmina/seed_manager.py`, `src/esper/kasmina/registry.py` | Partially Implemented | Nice‑to‑have | Teacher registration emits memory estimates against 7 GB budget; KD losses and activation plumbing remain deferred. |
| Rollback readiness | `02-kasmina-unified-design.md` | Emit checkpoints on stateful changes; 500 ms/12 s SLA | `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | Rollback payload recorded on gate failure/retire; SLA timing not instrumented. |
