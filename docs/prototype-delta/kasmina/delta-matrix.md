# Kasmina — Delta Matrix

Status and evidence per requirement. See rubric in `../rubric.md`.

| Area | Design Source | Expected Behaviour | Prototype Evidence | Status | Severity | Notes |
| --- | --- | --- | --- | --- | --- | --- |
| Lifecycle states & gates | `02-kasmina.md` (Lifecycle), legacy 11‑state with G0–G5 | Enforce 11 states with validation gates; transitions guarded | `src/esper/kasmina/lifecycle.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | Leyline enum is the single source of truth; gates G0–G5 enforced via `_ensure_gate`, embargo/reset loop implemented. |
| Lifecycle fast path | `02-kasmina.md` | Allow germinating→training fast path | `tests/kasmina/test_lifecycle.py` | Implemented | Nice‑to‑have | Covered by tests. |
| Kernel execution (Urza/Tezzeret) | `02.1-kasmina-kernel-execution.md` | Load vetted kernel artefacts; async path; GPU cache | `src/esper/kasmina/seed_manager.py` (runtime.fetch_kernel) | Partially Implemented | Should‑have | Synchronous fetch with simple fallback; no GPU‑resident cache or async scheduling. |
| Fallback kernel | `02.1-kasmina-kernel-execution.md` | Identity/fallback kernel on failure or latency breach | `src/esper/kasmina/seed_manager.py` (`_load_fallback`) | Implemented | Should‑have | Budget breach triggers fallback and telemetry. |
| Gradient isolation invariant | `02-kasmina.md`, `02.1-kasmina-kernel-execution.md` | Runtime enforcement via backward hooks; `.detach()` in blending; breaker on violation | `src/esper/kasmina/isolation.py`, `src/esper/kasmina/seed_manager.py` | Partially Implemented | Must‑have | Backward hook monitor with blending helpers and breaker integration; dot-product evaluation still opt-in by callers. |
| Alpha blending phases | `02-kasmina.md` | Blend outputs during grafting; identity in training | `src/esper/kasmina/blending.py`, `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | Alpha schedule and `.detach()` blender available; runtime still uses fixed schedule. |
| Parameter registration | `02.3-kasmina-parameter-registration.md` | Register per‑seed params; validate updates; teacher immutability | `src/esper/kasmina/registry.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Must‑have | Registry tracks per-seed ownership and teacher parameters; validation exposed via `validate_parameters`. |
| Memory governance | `02.2-kasmina-memory-pools.md` | TTL caches, epoch GC, KD memory budgeting | `src/esper/kasmina/memory.py`, `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | TTL caches cover kernels/telemetry; KD budgeting hooks stubbed without thresholds. |
| Safety stack (breaker/timers) | `02.4-kasmina-safety-mechanisms.md` | Circuit breakers, monotonic timing, pause/identity semantics | `src/esper/kasmina/safety.py`, `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | Circuit breaker + monotonic timer wired around kernel fetch and telemetry; pause semantics still pending. |
| torch.compile fallback | `02.4-kasmina-safety-mechanisms.md` | Monitor and fall back on instability | — | Missing | Nice‑to‑have | Not implemented. |
| Security envelope | `02-kasmina.md` | HMAC‑SHA256, nonce, freshness on critical commands | `src/esper/kasmina/security.py`, `src/esper/kasmina/seed_manager.py` | Implemented | Should‑have | Commands require valid signature, nonce ledger, and freshness window before execution. |
| Telemetry pipeline | `02-kasmina.md` | Structured metrics/events, emergency bypass for critical alerts | `src/esper/core/telemetry.py`; seed_manager emissions | Partially Implemented | Should‑have | Metrics expanded, health indicators carry priority hints, rollback readiness surfaced; emergency transport still TODO. |
| Performance validation | `02.5-kasmina-performance-validation.md` | Benchmarks for kernel load, isolation overhead, Leyline limits, KD costs | — | Missing | Nice‑to‑have | No harness in prototype for Kasmina; broader profiling exists elsewhere. |
| Distributed coordination | `02-kasmina.md` | Epoch‑aligned barriers; Byzantine logging | `src/esper/kasmina/seed_manager.py` | Partially Implemented | Nice‑to‑have | Manager tracks current epoch for exported state; barrier orchestration still future work. |
| Knowledge distillation (C‑024) | `02-kasmina.md`, `02.1`, `02.2` | Teacher load/checkpointing; KD loss plumbing; memory budgeting | `src/esper/kasmina/seed_manager.py`, `src/esper/kasmina/registry.py` | Partially Implemented | Nice‑to‑have | Teacher registration + isolation protections landed; KD loss channel still TODO. |
| Rollback readiness | `02-kasmina.md` | Emit checkpoints on stateful changes; 500 ms/12 s SLA | `src/esper/kasmina/seed_manager.py` | Partially Implemented | Should‑have | Rollback payloads recorded on gate failures and retirements; SLA timing instrumentation outstanding. |
