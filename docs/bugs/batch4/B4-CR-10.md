# Finding Ticket: Cross-Domain Import from Tamiyo

---

## Ticket Metadata

| Field | Value |
|-------|-------|
| **Ticket ID** | `B4-CR-10` |
| **Severity** | `P4` |
| **Status** | `open` |
| **Batch** | 4 |
| **Agent** | `codereview` |
| **Domain** | `simic` |
| **Assignee** | |
| **Created** | 2024-12-27 |
| **Updated** | 2024-12-27 |

---

## Location

| Field | Value |
|-------|-------|
| **File(s)** | `/home/john/esper-lite/src/esper/simic/__init__.py` |
| **Line(s)** | `30` |
| **Function/Class** | Module-level import |

---

## Summary

**One-line summary:** Simic re-exports `safe` and `TaskConfig` from Tamiyo - unusual cross-package re-export.

**Category:**
- [ ] Correctness bug
- [ ] Race condition / concurrency
- [ ] Memory leak / resource issue
- [ ] Performance bottleneck
- [ ] Numerical stability
- [ ] torch.compile compatibility
- [ ] Dead code / unwired functionality
- [x] API design / contract violation
- [ ] Test coverage gap
- [ ] Documentation / naming
- [ ] Defensive programming violation
- [ ] Legacy code policy violation

---

## Detailed Description

### What's Wrong

The simic package imports and re-exports from tamiyo:

```python
from esper.tamiyo.policy.features import safe, TaskConfig
```

This creates a dependency from simic on tamiyo, and consumers can import these from either package:
- `from esper.simic import safe`
- `from esper.tamiyo.policy.features import safe`

### Why This Is Unusual

Cross-package re-exports blur module boundaries. Consumers may not realize they're using tamiyo functionality when importing from simic.

### Possible Justification

These may be commonly used together with simic's training code, making the re-export convenient.

---

## Recommended Fix

**Option A: Keep but document**
```python
# Re-exported for convenience - these are commonly used with PPOAgent
from esper.tamiyo.policy.features import safe, TaskConfig
```

**Option B: Remove re-export**
```python
# Remove from simic/__init__.py
# Consumers should import directly from tamiyo:
# from esper.tamiyo.policy.features import safe, TaskConfig
```

---

## Verification

### How to Verify the Fix

- [ ] Check if consumers use `from esper.simic import safe`
- [ ] If so: document the re-export
- [ ] If not: remove the re-export

---

## Related Findings

- Duplicated in DRL report (S-1) and PyTorch report (INI-1)

---

## Appendix

### Original Report Reference

**Report file:** `docs/temp/2712reports/batch4-codereview.md`
**Section:** "P4 (Style)" (SIM-1)

---

## Cross-Review (DRL Specialist)

| Verdict | **NEUTRAL** |
|---------|-------------|

**Evaluation:** This is an architectural layering issue, not RL-specific. The `safe()` tensor guard and `TaskConfig` are feature-extraction utilities tightly coupled to `signals_to_features()` in ppo.py, justifying the convenience re-export. Document rationale or centralize in leyline.

---

## Cross-Review (Code Review Specialist)

| Verdict | **NEUTRAL** |
|---------|-------------|

**Evaluation:** Finding is accurate but design is intentional. Grep shows `safe`/`TaskConfig` used across 40+ files; re-exporting from simic provides API convenience for training workflows. Add a documenting comment per Option A - not a policy violation.

---

## Cross-Review (PyTorch Specialist)

| Verdict | **ENDORSE** |
|---------|-------------|

**Evaluation:** Grep confirms zero consumers of `from esper.simic import safe/TaskConfig` - the re-exports exist but are unused. Remove per Option B - no PyTorch implications, purely architectural cleanup to reduce false coupling.
